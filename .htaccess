RewriteEngine On
RewriteBase /

# EXCEPCIÓN para Service Worker - NO redirigir sw.js
RewriteCond %{REQUEST_URI} !^/sw\.js$

# Redirigir todas las demás solicitudes a index.php si el archivo no existe
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]

# Directorio por defecto
DirectoryIndex index.php

# MIME types correctos
<IfModule mod_mime.c>
    AddType application/javascript .js
</IfModule>

# Headers específicos para Service Worker
<Files "sw.js">
    Header set Service-Worker-Allowed "/"
    Header set Content-Type "application/javascript"
    Header set Cache-Control "no-cache"
</Files>
